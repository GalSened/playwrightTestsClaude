# WeSign Deployment Environment Configuration
# Jenkins Pipeline Configuration for Windows DevTest Environment
#
# This file contains all environment variables and configuration settings
# required for the WeSign deployment pipeline.
#
# Security: All sensitive values should be stored in Jenkins Credentials
# and referenced using ${CREDENTIAL_ID} syntax in the pipeline.
#
# Version: 2.0
# Last Updated: 2025-09-26

#============================================================================
# ENVIRONMENT IDENTIFICATION
#============================================================================
ENVIRONMENT_NAME=devtest
DEPLOYMENT_ENVIRONMENT=DevTest
APPLICATION_NAME=WeSign
APPLICATION_VERSION=2.0

#============================================================================
# GIT REPOSITORY CONFIGURATION
#============================================================================
GIT_REPO_URL=https://gitlab.comda.co.il/comsigntrust/comsigntrustcms.git
GIT_CREDENTIAL_ID=gitlab-wesign-deploy-key
GIT_DEFAULT_BRANCH=main
GIT_CHECKOUT_TIMEOUT=20
GIT_CLONE_DEPTH=1

#============================================================================
# TARGET ENVIRONMENT - WINDOWS DEVTEST
#============================================================================
# Server Configuration
DEVTEST_SERVER=devtest-iis01.company.local
DEVTEST_DOMAIN=company.local
DEVTEST_IP=192.168.10.50

# Authentication
DEVTEST_CREDENTIAL_ID=wesign-devtest-deploy-user
DOMAIN_CREDENTIAL_ID=wesign-domain-service-account

# File Shares and Paths
DEVTEST_SHARE=\\\\devtest-iis01.company.local\\WeSignDeploy$
DEVTEST_APP_PATH=C:\\inetpub\\wwwroot\\WeSign
DEVTEST_BACKUP_PATH=C:\\Backups\\WeSign
DEVTEST_LOGS_PATH=C:\\Logs\\WeSign

# IIS Configuration
IIS_SITE_NAME=WeSign
IIS_APP_POOL=WeSignAppPool
IIS_PORT=443
IIS_PROTOCOL=https
IIS_BINDING_IP=*

#============================================================================
# NETWORK CONNECTIVITY
#============================================================================
# WinRM Configuration
WINRM_HTTPS_PORT=5986
WINRM_HTTP_PORT=5985
WINRM_TIMEOUT=300
WINRM_MAX_MEMORY_PER_SHELL=512

# SMB Configuration
SMB_TIMEOUT=120
SMB_RETRY_COUNT=3
SMB_RETRY_DELAY=10

# General Network
PING_COUNT=4
PING_TIMEOUT=5000
CONNECTION_TIMEOUT=30

#============================================================================
# QA INTELLIGENCE BACKEND INTEGRATION
#============================================================================
QA_BACKEND_URL=http://localhost:8082
QA_BACKEND_TOKEN_ID=qa-intelligence-backend-token
QA_API_TIMEOUT=30
QA_HEALTH_CHECK_ENDPOINT=/health
QA_WESIGN_API_BASE=/api/wesign/unified
QA_REPORTING_ENABLED=true

# WebSocket Configuration for Real-time Updates
QA_WEBSOCKET_URL=ws://localhost:8082/ws/wesign
QA_WEBSOCKET_TIMEOUT=60

#============================================================================
# BUILD CONFIGURATION
#============================================================================
# .NET Build Settings
DOTNET_VERSION=8.0
DOTNET_CONFIGURATION=Release
DOTNET_VERBOSITY=minimal
DOTNET_CLI_TELEMETRY_OPTOUT=true
DOTNET_SKIP_FIRST_TIME_EXPERIENCE=true

# MSBuild Settings
MSBUILD_CONFIGURATION=Release
MSBUILD_PLATFORM=Any CPU
MSBUILD_VERBOSITY=minimal
MSBUILD_MAX_CPU_COUNT=4

# NuGet Settings
NUGET_RESTORE_TIMEOUT=600
NUGET_PACKAGE_SOURCE=https://api.nuget.org/v3/index.json

#============================================================================
# TESTING CONFIGURATION
#============================================================================
# Unit Testing
UNIT_TEST_TIMEOUT=600
UNIT_TEST_RESULTS_PATH=./TestResults
UNIT_TEST_LOGGER=trx
UNIT_TEST_COVERAGE=true

# Integration Testing
API_TEST_COLLECTION=tests/WeSign-API-Collection.postman_collection.json
API_TEST_ENVIRONMENT=tests/DevTest-Environment.postman_environment.json
API_TEST_TIMEOUT=30000
API_TEST_DELAY=1000

# E2E Testing
E2E_TEST_PATH=tests/e2e/
E2E_TEST_BROWSER=chromium
E2E_TEST_HEADLESS=true
E2E_TEST_TIMEOUT=60000
E2E_BASE_URL=https://devtest-iis01.company.local
E2E_TEST_USERNAME=testuser
E2E_TEST_PASSWORD_ID=wesign-e2e-test-credentials

# Python Configuration for E2E Tests
PYTHON_CMD=py
PYTHON_REQUIREMENTS=pytest,playwright,pytest-html
PLAYWRIGHT_BROWSERS=chromium

#============================================================================
# DEPLOYMENT CONFIGURATION
#============================================================================
# Package Settings
PACKAGE_COMPRESSION=zip
PACKAGE_CHECKSUM_ALGORITHM=SHA256
PACKAGE_RETENTION_DAYS=30

# Deployment Timeouts
DEPLOYMENT_TIMEOUT=600
HEALTH_CHECK_TIMEOUT=300
WARMUP_TIMEOUT=180
IIS_RESTART_TIMEOUT=60

# Backup Settings
BACKUP_ENABLED=true
BACKUP_RETENTION_DAYS=30
BACKUP_COMPRESSION=true
BACKUP_VERIFY_RESTORE=true

# Configuration Transformation
CONFIG_TRANSFORM_ENABLED=true
CONFIG_ENVIRONMENT=devtest
CONFIG_CONNECTION_STRING=Data Source=devtest-sql01;Initial Catalog=WeSignDevTest;Integrated Security=true

#============================================================================
# MONITORING AND HEALTH CHECKS
#============================================================================
# Health Check Endpoints
HEALTH_CHECK_MAIN=/
HEALTH_CHECK_API=/api/health
HEALTH_CHECK_DATABASE=/api/health/database
HEALTH_CHECK_DEPENDENCIES=/api/health/dependencies

# Smoke Test Configuration
SMOKE_TEST_TIMEOUT=30
SMOKE_TEST_RETRY_COUNT=3
SMOKE_TEST_RETRY_DELAY=10
SMOKE_TEST_CRITICAL_ONLY=false

# Warmup Configuration
WARMUP_ATTEMPTS=10
WARMUP_DELAY=10
WARMUP_ENDPOINTS=/,/health,/api/health

#============================================================================
# NOTIFICATION CONFIGURATION
#============================================================================
# Email Settings
EMAIL_ENABLED=true
EMAIL_SMTP_SERVER=smtp.company.local
EMAIL_FROM=jenkins-wesign@company.com
EMAIL_RECIPIENTS=devops@company.com,qa-team@company.com
EMAIL_ATTACH_LOGS=false
EMAIL_HTML_FORMAT=true

# Teams Integration
TEAMS_ENABLED=true
TEAMS_WEBHOOK_URL_ID=teams-webhook-wesign-deployment
TEAMS_MENTION_ON_FAILURE=true

# Notification Priorities
NOTIFICATION_SUCCESS_PRIORITY=normal
NOTIFICATION_FAILURE_PRIORITY=high
NOTIFICATION_UNSTABLE_PRIORITY=normal

#============================================================================
# SECURITY CONFIGURATION
#============================================================================
# SSL/TLS Settings
SSL_VERIFY_CERTIFICATES=true
SSL_ALLOW_SELF_SIGNED=false
TLS_VERSION=1.2

# Credential References (Jenkins Credentials Plugin)
CREDENTIALS_DOMAIN_SERVICE_ACCOUNT=wesign-domain-service-account
CREDENTIALS_DEVTEST_DEPLOY_USER=wesign-devtest-deploy-user
CREDENTIALS_QA_BACKEND_TOKEN=qa-intelligence-backend-token
CREDENTIALS_GIT_DEPLOY_KEY=gitlab-wesign-deploy-key
CREDENTIALS_E2E_TEST_USER=wesign-e2e-test-credentials
CREDENTIALS_TEAMS_WEBHOOK=teams-webhook-wesign-deployment

# Security Policies
ALLOW_FORCE_DEPLOY=true
REQUIRE_APPROVAL_FOR_PROD=true
LOG_CREDENTIAL_ACCESS=true
MASK_SENSITIVE_VALUES=true

#============================================================================
# WINDOWS-SPECIFIC CONFIGURATION
#============================================================================
# PowerShell Settings
POWERSHELL_EXECUTION_POLICY=RemoteSigned
POWERSHELL_VERSION=5.1
POWERSHELL_TIMEOUT=300

# Windows Services
WINDOWS_SERVICE_TIMEOUT=30
WINDOWS_EVENT_LOG_SOURCE=WeSignDeployment

# File System Settings
FILESYSTEM_ENCODING=UTF-8
FILE_COPY_BUFFER_SIZE=1MB
DIRECTORY_PERMISSIONS=FullControl

#============================================================================
# PIPELINE BEHAVIOR CONFIGURATION
#============================================================================
# Build Retention
BUILD_DAYS_TO_KEEP=30
BUILD_NUM_TO_KEEP=50
ARTIFACT_DAYS_TO_KEEP=14
ARTIFACT_NUM_TO_KEEP=20

# Concurrent Builds
DISABLE_CONCURRENT_BUILDS=true
PIPELINE_TIMEOUT_MINUTES=60

# Workspace Management
WORKSPACE_CLEANUP=selective
WORKSPACE_CLEANUP_PATTERNS=*.tmp,*.log,Package/,TestResults/

# Error Handling
CONTINUE_ON_TEST_FAILURE=false
RETRY_FAILED_STAGES=false
AUTO_ROLLBACK_ON_FAILURE=true

#============================================================================
# LOGGING AND DEBUGGING
#============================================================================
# Log Levels
LOG_LEVEL=INFO
DEBUG_ENABLED=false
VERBOSE_OUTPUT=false

# Log Retention
LOG_RETENTION_DAYS=30
LOG_COMPRESSION=true
LOG_ROTATION_SIZE=100MB

# Audit Trail
AUDIT_ENABLED=true
AUDIT_LOG_PATH=C:\\Logs\\WeSign\\Deployment\\Audit
AUDIT_RETENTION_DAYS=90

#============================================================================
# PERFORMANCE TUNING
#============================================================================
# Resource Limits
MAX_PARALLEL_STAGES=3
MAX_CONCURRENT_DOWNLOADS=2
MAX_MEMORY_USAGE=2GB
MAX_CPU_PERCENTAGE=80

# Timeouts
HTTP_REQUEST_TIMEOUT=30
FILE_TRANSFER_TIMEOUT=600
REMOTE_COMMAND_TIMEOUT=120

# Caching
ENABLE_BUILD_CACHE=true
CACHE_EXPIRY_HOURS=24
CACHE_SIZE_LIMIT=1GB

#============================================================================
# FEATURE FLAGS
#============================================================================
# Experimental Features
ENABLE_PARALLEL_TESTING=true
ENABLE_INCREMENTAL_DEPLOYMENT=false
ENABLE_BLUE_GREEN_DEPLOYMENT=false
ENABLE_CANARY_DEPLOYMENT=false

# Integration Features
ENABLE_JIRA_INTEGRATION=true
ENABLE_SLACK_INTEGRATION=false
ENABLE_PROMETHEUS_METRICS=true
ENABLE_GRAFANA_DASHBOARDS=true

# Quality Gates
ENFORCE_CODE_COVERAGE=false
MIN_CODE_COVERAGE=80
ENFORCE_SECURITY_SCAN=false
ENFORCE_DEPENDENCY_CHECK=true

#============================================================================
# DISASTER RECOVERY
#============================================================================
# Backup Strategy
BACKUP_STRATEGY=incremental
BACKUP_COMPRESSION_LEVEL=9
BACKUP_ENCRYPTION=false
BACKUP_OFFSITE_COPY=false

# Recovery Configuration
RECOVERY_POINT_OBJECTIVE=4h
RECOVERY_TIME_OBJECTIVE=30min
AUTO_RECOVERY_ENABLED=true
MANUAL_INTERVENTION_REQUIRED=false

#============================================================================
# COMPLIANCE AND GOVERNANCE
#============================================================================
# Compliance Requirements
SOX_COMPLIANCE=false
GDPR_COMPLIANCE=true
AUDIT_TRAIL_REQUIRED=true
CHANGE_APPROVAL_REQUIRED=false

# Documentation
DEPLOYMENT_DOCUMENTATION_REQUIRED=true
ARCHITECTURE_REVIEW_REQUIRED=false
SECURITY_REVIEW_REQUIRED=false

# End of Configuration File
# For questions or updates, contact: DevOps Team <devops@company.com>