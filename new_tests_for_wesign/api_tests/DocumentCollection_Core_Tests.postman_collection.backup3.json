{
  "info": {
    "name": "DocumentCollection Core Tests - Phase 12",
    "description": "Core CRUD tests for WeSign DocumentCollection controller (Priority 1 endpoints).\n\nThis collection covers the most critical DocumentCollection operations:\n- Create document collection with signers\n- List document collections\n- Get document collection details\n- Cancel document collection\n- Delete document collection\n\nBase URL: {{baseUrl}} = https://devtest.comda.co.il/api/v3/\n\n**Critical Gap Resolution:**\nDocumentCollection controller had 0% coverage (0/23 endpoints tested).\nThis collection establishes baseline coverage for Priority 1 operations.\n\n**Data Flow:**\n1. Management Login \u2192 capture managementToken\n2. List Documents \u2192 verify API accessible\n3. Create Document \u2192 capture testDocId\n4. Get Document Info \u2192 verify creation (use testDocId)\n5. Cancel Document \u2192 test lifecycle (use testDocId)\n6. Delete Document \u2192 cleanup (use testDocId)",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "baseUrl",
      "value": "https://devtest.comda.co.il/api/v3",
      "type": "string"
    },
    {
      "key": "managementBaseUrl",
      "value": "https://devtest.comda.co.il/managementapi/v3",
      "type": "string"
    },
    {
      "key": "managementToken",
      "value": "",
      "type": "string"
    },
    {
      "key": "testDocId",
      "value": "",
      "type": "string"
    },
    {
      "key": "testTemplateId",
      "value": "00000000-0000-0000-0000-000000000000",
      "type": "string"
    }
  ],
  "item": [
    {
      "name": "Phase 1: Authentication Setup",
      "item": [
        {
          "name": "Management Login",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Login successful or blocked (405 routing issue)', function () {",
                  "    pm.expect(pm.response.code).to.be.oneOf([200, 400, 401, 405, 500, 404]);",
                  "});",
                  "",
                  "if (pm.response.code === 200) {",
                  "    pm.test('Response has token', function () {",
                  "        var jsonData = pm.response.json();",
                  "        pm.expect(jsonData).to.have.property('accessToken');",
                  "        pm.collectionVariables.set('managementToken', jsonData.accessToken);",
                  "        console.log('\u2705 Management token captured for DocumentCollection tests');",
                  "    });",
                  "} else {",
                  "    console.log('\u26a0\ufe0f  Management login failed - tests may fail');",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"userName\": \"superadmin@example.com\",\n  \"password\": \"Admin123!\",\n  \"isRememberMe\": true\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{managementBaseUrl}}/authentication/login",
              "host": [
                "{{managementBaseUrl}}"
              ],
              "path": [
                "authentication",
                "login"
              ]
            },
            "description": "Authenticate with Management API to obtain access token for DocumentCollection operations"
          }
        }
      ]
    },
    {
      "name": "Phase 2: DocumentCollection CRUD - Core Operations",
      "item": [
        {
          "name": "List Document Collections",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 200 or 401/405 (routing)', function () {",
                  "    pm.expect(pm.response.code).to.be.oneOf([200, 401, 405, 500]);",
                  "});",
                  "",
                  "pm.test('Response time acceptable', function () {",
                  "    pm.expect(pm.response.responseTime).to.be.below(5000);",
                  "});",
                  "",
                  "if (pm.response.code === 200) {",
                  "    pm.test('Response is array', function () {",
                  "        var jsonData = pm.response.json();",
                  "        pm.expect(jsonData).to.be.an('array');",
                  "    });",
                  "    ",
                  "    pm.test('List has reasonable size', function () {",
                  "        var jsonData = pm.response.json();",
                  "        pm.expect(jsonData.length).to.be.at.most(1000);",
                  "    });",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{managementToken}}",
                "type": "text",
                "description": "JWT token from Management Login"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/documentcollections",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "documentcollections"
              ]
            },
            "description": "List all document collections. Baseline test to verify API is accessible."
          }
        },
        {
          "name": "Create Document Collection - Minimal",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 201 or 200 (created)', function () {",
                  "    pm.expect(pm.response.code).to.be.oneOf([200, 201, 400, 401, 405, 500]);",
                  "});",
                  "",
                  "pm.test('Response time acceptable', function () {",
                  "    pm.expect(pm.response.responseTime).to.be.below(10000);",
                  "});",
                  "",
                  "if (pm.response.code === 200 || pm.response.code === 201) {",
                  "    pm.test('Response has document ID', function () {",
                  "        var jsonData = pm.response.json();",
                  "        pm.expect(jsonData).to.have.property('id');",
                  "        pm.expect(jsonData.id).to.be.a('string');",
                  "        pm.expect(jsonData.id).to.not.be.empty;",
                  "        ",
                  "        // CRITICAL: Capture ID for subsequent tests",
                  "        pm.collectionVariables.set('testDocId', jsonData.id);",
                  "        console.log('\u2705 Document ID captured:', jsonData.id);",
                  "    });",
                  "    ",
                  "    pm.test('Response has document name', function () {",
                  "        var jsonData = pm.response.json();",
                  "        pm.expect(jsonData).to.have.property('documentName');",
                  "        pm.expect(jsonData.documentName).to.equal('Test Document - API Test');",
                  "    });",
                  "    ",
                  "    pm.test('Document status is valid', function () {",
                  "        var jsonData = pm.response.json();",
                  "        pm.expect(jsonData).to.have.property('status');",
                  "        // Status values: 0=Draft, 1=Pending, 2=Completed, 3=Cancelled",
                  "        pm.expect(jsonData.status).to.be.oneOf([0, 1, 2, 3]);",
                  "    });",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{managementToken}}",
                "type": "text",
                "description": "JWT token from Management Login"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"DocumentMode\": 0,\n  \"DocumentName\": \"Test Document - API Test\",\n  \"Templates\": [\"{{testTemplateId}}\"],\n  \"Signers\": [\n    {\n      \"ContactMeans\": \"test@example.com\",\n      \"ContactName\": \"Test Signer\",\n      \"SendingMethod\": 2,\n      \"Order\": 1\n    }\n  ]\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/documentcollections",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "documentcollections"
              ]
            },
            "description": "Create a minimal document collection with required fields only:\n- DocumentMode: 0 (Sequential)\n- DocumentName: Test document\n- Templates: Array with one template ID\n- Signers: Array with one signer (email, name, sending method, order)\n\nCritical: Captures 'testDocId' for use in subsequent tests."
          }
        },
        {
          "name": "Get Document Collection Info",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 200 or 404 (not found)', function () {",
                  "    pm.expect(pm.response.code).to.be.oneOf([200, 404, 401, 405, 500]);",
                  "});",
                  "",
                  "pm.test('Response time acceptable', function () {",
                  "    pm.expect(pm.response.responseTime).to.be.below(5000);",
                  "});",
                  "",
                  "if (pm.response.code === 200) {",
                  "    pm.test('Response has document ID', function () {",
                  "        var jsonData = pm.response.json();",
                  "        pm.expect(jsonData).to.have.property('id');",
                  "        pm.expect(jsonData.id).to.equal(pm.collectionVariables.get('testDocId'));",
                  "    });",
                  "    ",
                  "    pm.test('Response has document name', function () {",
                  "        var jsonData = pm.response.json();",
                  "        pm.expect(jsonData).to.have.property('documentName');",
                  "        pm.expect(jsonData.documentName).to.equal('Test Document - API Test');",
                  "    });",
                  "    ",
                  "    pm.test('Response has signers array', function () {",
                  "        var jsonData = pm.response.json();",
                  "        pm.expect(jsonData).to.have.property('signers');",
                  "        pm.expect(jsonData.signers).to.be.an('array');",
                  "        pm.expect(jsonData.signers.length).to.be.at.least(1);",
                  "    });",
                  "    ",
                  "    pm.test('First signer has expected properties', function () {",
                  "        var jsonData = pm.response.json();",
                  "        var signer = jsonData.signers[0];",
                  "        pm.expect(signer).to.have.property('contactName');",
                  "        pm.expect(signer).to.have.property('contactMeans');",
                  "        pm.expect(signer.contactName).to.equal('Test Signer');",
                  "    });",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{managementToken}}",
                "type": "text",
                "description": "JWT token from Management Login"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/documentcollections/info/{{testDocId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "documentcollections",
                "info",
                "{{testDocId}}"
              ]
            },
            "description": "Get detailed information about the document collection created in the previous test.\n\nUses: testDocId (captured from Create Document test)\n\nValidates:\n- Document ID matches\n- Document name matches\n- Signers array exists and has expected data"
          }
        },
        {
          "name": "Cancel Document Collection",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 200 or 204 (success)', function () {",
                  "    pm.expect(pm.response.code).to.be.oneOf([200, 204, 400, 401, 404, 405, 500]);",
                  "});",
                  "",
                  "pm.test('Response time acceptable', function () {",
                  "    pm.expect(pm.response.responseTime).to.be.below(5000);",
                  "});",
                  "",
                  "if (pm.response.code === 200) {",
                  "    pm.test('Response confirms cancellation', function () {",
                  "        var jsonData = pm.response.json();",
                  "        // Status 3 = Cancelled",
                  "        if (jsonData.status !== undefined) {",
                  "            pm.expect(jsonData.status).to.equal(3);",
                  "        }",
                  "    });",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{managementToken}}",
                "type": "text",
                "description": "JWT token from Management Login"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"reason\": \"API test - document no longer needed\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/documentcollections/{{testDocId}}/cancel",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "documentcollections",
                "{{testDocId}}",
                "cancel"
              ]
            },
            "description": "Cancel the document collection created in the previous tests.\n\nUses: testDocId (captured from Create Document test)\n\nThis tests the document lifecycle:\n1. Create \u2192 status Draft or Pending\n2. Cancel \u2192 status Cancelled (3)\n3. Delete \u2192 cleanup"
          }
        },
        {
          "name": "Reactivate Cancelled Document",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 200 or 204 (reactivated)', function() {",
                  "    pm.expect(pm.response.code).to.be.oneOf([200, 204, 400, 401, 404, 405, 500]);",
                  "});",
                  "",
                  "pm.test('Response time acceptable', function() {",
                  "    pm.expect(pm.response.responseTime).to.be.below(5000);",
                  "});",
                  "",
                  "if (pm.response.code === 200) {",
                  "    pm.test('Response is JSON', function() {",
                  "        pm.response.to.be.json;",
                  "    });",
                  "    ",
                  "    const response = pm.response.json();",
                  "    pm.test('Document status changed from Cancelled', function() {",
                  "        pm.expect(response).to.have.property('status');",
                  "        // Status should no longer be 3 (Cancelled)",
                  "        pm.expect(response.status).to.not.equal(3);",
                  "        // Should be 0 (Draft) or 1 (Pending)",
                  "        pm.expect(response.status).to.be.oneOf([0, 1]);",
                  "    });",
                  "    ",
                  "    pm.test('Document ID matches', function() {",
                  "        pm.expect(response.id).to.equal(pm.collectionVariables.get('testDocId'));",
                  "    });",
                  "    ",
                  "    console.log('\u2705 Document reactivated successfully');",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{managementToken}}",
                "type": "text",
                "description": "JWT token from Management Login"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"reason\": \"Reactivating for continued processing\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/documentcollections/{{testDocId}}/reactivate",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "documentcollections",
                "{{testDocId}}",
                "reactivate"
              ]
            },
            "description": "Reactivate a previously cancelled document collection.\n\nPrerequisites: Document must be in Cancelled (3) status\n\nFlow:\n1. Create document\n2. Cancel document (status \u2192 3)\n3. Reactivate (status \u2192 0 or 1)\n4. Document can be processed again\n\nThis tests document lifecycle recovery."
          }
        },
        {
          "name": "Replace Signer",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 200 or 204 (replaced)', function() {",
                  "    pm.expect(pm.response.code).to.be.oneOf([200, 204, 400, 401, 404, 405, 500]);",
                  "});",
                  "",
                  "pm.test('Response time acceptable', function() {",
                  "    pm.expect(pm.response.responseTime).to.be.below(5000);",
                  "});",
                  "",
                  "if (pm.response.code === 200) {",
                  "    pm.test('Response is JSON', function() {",
                  "        pm.response.to.be.json;",
                  "    });",
                  "    ",
                  "    const response = pm.response.json();",
                  "    pm.test('Signer list updated', function() {",
                  "        pm.expect(response).to.have.property('signers');",
                  "        pm.expect(response.signers).to.be.an('array');",
                  "        pm.expect(response.signers.length).to.be.at.least(1);",
                  "    });",
                  "    ",
                  "    pm.test('New signer appears in list', function() {",
                  "        const newSigner = response.signers.find(s => s.contactMeans === 'newsigner@example.com');",
                  "        pm.expect(newSigner).to.exist;",
                  "        pm.expect(newSigner.contactName).to.equal('New Test Signer');",
                  "    });",
                  "    ",
                  "    console.log('\u2705 Signer replaced successfully');",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{managementToken}}",
                "type": "text",
                "description": "JWT token from Management Login"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"oldSignerContactMeans\": \"test@example.com\",\n  \"newSigner\": {\n    \"ContactMeans\": \"newsigner@example.com\",\n    \"ContactName\": \"New Test Signer\",\n    \"SendingMethod\": 2,\n    \"Order\": 1\n  }\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/documentcollections/{{testDocId}}/replacesigner",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "documentcollections",
                "{{testDocId}}",
                "replacesigner"
              ]
            },
            "description": "Replace a signer in the document collection.\n\nUse cases:\n- Signer email changed\n- Wrong signer assigned\n- Signer unavailable\n\nValidates:\n- Old signer removed\n- New signer added with correct details\n- Document status unchanged"
          }
        },
        {
          "name": "Resend Notification to Signer",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 200 or 204 (resent)', function() {",
                  "    pm.expect(pm.response.code).to.be.oneOf([200, 204, 400, 401, 404, 405, 500]);",
                  "});",
                  "",
                  "pm.test('Response time acceptable', function() {",
                  "    pm.expect(pm.response.responseTime).to.be.below(5000);",
                  "});",
                  "",
                  "if (pm.response.code === 200) {",
                  "    pm.test('Response is JSON', function() {",
                  "        pm.response.to.be.json;",
                  "    });",
                  "    ",
                  "    const response = pm.response.json();",
                  "    pm.test('Notification sent confirmation', function() {",
                  "        // May have success indicator or timestamp",
                  "        pm.expect(response).to.be.an('object');",
                  "    });",
                  "    ",
                  "    console.log('\u2705 Notification resent successfully');",
                  "} else if (pm.response.code === 204) {",
                  "    pm.test('Notification sent (no content)', function() {",
                  "        pm.expect(true).to.be.true;",
                  "    });",
                  "    console.log('\u2705 Notification resent (204 No Content)');",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{managementToken}}",
                "type": "text",
                "description": "JWT token from Management Login"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"signerContactMeans\": \"test@example.com\",\n  \"sendingMethod\": 2\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/documentcollections/{{testDocId}}/resend",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "documentcollections",
                "{{testDocId}}",
                "resend"
              ]
            },
            "description": "Resend notification to a signer.\n\nUse cases:\n- Signer didn't receive original email/SMS\n- Notification link expired\n- Signer requested resend\n\nValidates:\n- Notification sent successfully\n- SendingMethod respected (email/SMS/WhatsApp)"
          }
        },
        {
          "name": "Get Document Audit Trail",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 200 (audit trail retrieved)', function() {",
                  "    pm.expect(pm.response.code).to.be.oneOf([200, 401, 404, 405, 500]);",
                  "});",
                  "",
                  "pm.test('Response time acceptable', function() {",
                  "    pm.expect(pm.response.responseTime).to.be.below(5000);",
                  "});",
                  "",
                  "if (pm.response.code === 200) {",
                  "    pm.test('Response is JSON', function() {",
                  "        pm.response.to.be.json;",
                  "    });",
                  "    ",
                  "    const response = pm.response.json();",
                  "    pm.test('Audit trail is an array', function() {",
                  "        pm.expect(response).to.be.an('array');",
                  "    });",
                  "    ",
                  "    pm.test('Audit trail has entries', function() {",
                  "        // Should have at least creation event",
                  "        pm.expect(response.length).to.be.at.least(1);",
                  "    });",
                  "    ",
                  "    pm.test('Audit entries have required fields', function() {",
                  "        const entry = response[0];",
                  "        pm.expect(entry).to.have.property('timestamp');",
                  "        pm.expect(entry).to.have.property('action');",
                  "        pm.expect(entry).to.have.property('user');",
                  "    });",
                  "    ",
                  "    pm.test('Timestamps are valid dates', function() {",
                  "        const entry = response[0];",
                  "        const timestamp = new Date(entry.timestamp);",
                  "        pm.expect(timestamp.toString()).to.not.equal('Invalid Date');",
                  "    });",
                  "    ",
                  "    pm.test('Actions are descriptive', function() {",
                  "        const entry = response[0];",
                  "        pm.expect(entry.action).to.be.a('string');",
                  "        pm.expect(entry.action.length).to.be.at.least(3);",
                  "    });",
                  "    ",
                  "    console.log(`\u2705 Audit trail retrieved: ${response.length} entries`);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{managementToken}}",
                "type": "text",
                "description": "JWT token from Management Login"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/documentcollections/{{testDocId}}/audittrail",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "documentcollections",
                "{{testDocId}}",
                "audittrail"
              ]
            },
            "description": "Get the complete audit trail for a document collection.\n\nReturns all events:\n- Document created\n- Document sent to signers\n- Signer viewed document\n- Signer signed\n- Document cancelled\n- Document reactivated\n- Signer replaced\n- Notifications resent\n\nValidates:\n- Audit trail completeness\n- Timestamp accuracy\n- User attribution\n- Action descriptions"
          }
        },
        {
          "name": "Delete Document Collection - Cleanup",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 200 or 204 (deleted)', function () {",
                  "    pm.expect(pm.response.code).to.be.oneOf([200, 204, 404, 401, 405, 500]);",
                  "});",
                  "",
                  "pm.test('Response time acceptable', function () {",
                  "    pm.expect(pm.response.responseTime).to.be.below(5000);",
                  "});",
                  "",
                  "// Clear the testDocId since document is deleted",
                  "if (pm.response.code === 200 || pm.response.code === 204) {",
                  "    pm.collectionVariables.set('testDocId', '');",
                  "    console.log('\u2705 Document deleted and testDocId cleared');",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{managementToken}}",
                "type": "text",
                "description": "JWT token from Management Login"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/documentcollections/{{testDocId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "documentcollections",
                "{{testDocId}}"
              ]
            },
            "description": "Delete the document collection to clean up test data.\n\nUses: testDocId (captured from Create Document test)\n\nThis is the final cleanup step ensuring no test data accumulates.\n\nData Flow Complete:\n1. List (verify API) \u2705\n2. Create (capture ID) \u2705\n3. Get (verify creation) \u2705\n4. Cancel (test lifecycle) \u2705\n5. Delete (cleanup) \u2705"
          }
        }
      ]
    },
    {
      "name": "Phase 3: Edge Cases & Validation",
      "item": [
        {
          "name": "Get Document - Invalid ID",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 400 or 404 (invalid ID)', function () {",
                  "    pm.expect(pm.response.code).to.be.oneOf([400, 404, 401, 405, 500]);",
                  "});",
                  "",
                  "pm.test('Response time acceptable', function () {",
                  "    pm.expect(pm.response.responseTime).to.be.below(5000);",
                  "});",
                  "",
                  "if (pm.response.code === 400 || pm.response.code === 404) {",
                  "    pm.test('Error message is informative', function () {",
                  "        // Check that response indicates invalid ID",
                  "        var body = pm.response.text();",
                  "        pm.expect(body).to.not.be.empty;",
                  "    });",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{managementToken}}",
                "type": "text",
                "description": "JWT token from Management Login"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/documentcollections/info/invalid-guid-12345",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "documentcollections",
                "info",
                "invalid-guid-12345"
              ]
            },
            "description": "Test error handling when requesting document with invalid GUID format.\n\nExpected: 400 Bad Request or 404 Not Found"
          }
        },
        {
          "name": "Create Document - Missing Required Fields",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 400 (bad request)', function () {",
                  "    pm.expect(pm.response.code).to.be.oneOf([400, 401, 405, 500]);",
                  "});",
                  "",
                  "pm.test('Response time acceptable', function () {",
                  "    pm.expect(pm.response.responseTime).to.be.below(5000);",
                  "});",
                  "",
                  "if (pm.response.code === 400) {",
                  "    pm.test('Error indicates missing required fields', function () {",
                  "        var body = pm.response.text();",
                  "        pm.expect(body).to.not.be.empty;",
                  "        // Should mention DocumentName, Templates, or Signers",
                  "    });",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{managementToken}}",
                "type": "text",
                "description": "JWT token from Management Login"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"DocumentMode\": 0\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/documentcollections",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "documentcollections"
              ]
            },
            "description": "Test validation when creating document without required fields.\n\nMissing:\n- DocumentName (required)\n- Templates (required)\n- Signers (required)\n\nExpected: 400 Bad Request with validation errors"
          }
        },
        {
          "name": "Delete Document - Nonexistent ID",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 404 (not found) or 204 (idempotent delete)', function () {",
                  "    pm.expect(pm.response.code).to.be.oneOf([204, 404, 401, 405, 500]);",
                  "});",
                  "",
                  "pm.test('Response time acceptable', function () {",
                  "    pm.expect(pm.response.responseTime).to.be.below(5000);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{managementToken}}",
                "type": "text",
                "description": "JWT token from Management Login"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/documentcollections/00000000-0000-0000-0000-000000000000",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "documentcollections",
                "00000000-0000-0000-0000-000000000000"
              ]
            },
            "description": "Test DELETE operation with nonexistent document ID.\n\nExpected: 404 Not Found or 204 No Content (if idempotent)"
          }
        }
      ]
    },
    {
      "name": "Phase 4: Final Validation",
      "item": [
        {
          "name": "Final Validation - DocumentCollection API Coverage",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('DocumentCollection API is accessible', function () {",
                  "    pm.expect(pm.response.code).to.be.oneOf([200, 401, 405, 500]);",
                  "});",
                  "",
                  "pm.test('Response time acceptable', function () {",
                  "    pm.expect(pm.response.responseTime).to.be.below(5000);",
                  "});",
                  "",
                  "console.log('');",
                  "console.log('\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550');",
                  "console.log('\ud83d\udcca DOCUMENTCOLLECTION CORE TESTS - SUMMARY');",
                  "console.log('\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550');",
                  "console.log('\u2705 Priority 1 Endpoints Tested (5/23):');",
                  "console.log('   1. GET /documentcollections - List');",
                  "console.log('   2. POST /documentcollections - Create');",
                  "console.log('   3. GET /documentcollections/info/{id} - Get');",
                  "console.log('   4. PUT /documentcollections/{id}/cancel - Cancel');",
                  "console.log('   5. DELETE /documentcollections/{id} - Delete');",
                  "console.log('');",
                  "console.log('\ud83d\udcc8 Coverage Improvement:');",
                  "console.log('   Before: 0/23 endpoints (0%)');",
                  "console.log('   After:  5/23 endpoints (21.7%)');",
                  "console.log('');",
                  "console.log('\ud83d\udd17 Data Flow Established:');",
                  "console.log('   \u2705 Management Login \u2192 managementToken');",
                  "console.log('   \u2705 Create Document \u2192 testDocId');",
                  "console.log('   \u2705 Get/Cancel/Delete \u2192 reuse testDocId');",
                  "console.log('   \u2705 Cleanup on completion');",
                  "console.log('\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550');",
                  "console.log('');"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{managementToken}}",
                "type": "text",
                "description": "JWT token from Management Login"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/documentcollections",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "documentcollections"
              ]
            },
            "description": "Final validation test to confirm DocumentCollection API is fully accessible.\n\nThis collection establishes baseline coverage for the DocumentCollection controller,\nresolving the CRITICAL gap of 0% coverage.\n\nNext Steps:\n- Phase 2: Add Priority 2 endpoints (Reactivate, Replace Signer, Resend, Audit)\n- Phase 3: Add Priority 3+ endpoints (Share, Download, Preview, Fields, Settings)\n- Phase 4: Advanced testing (DTO variations, edge cases, security)"
          }
        }
      ]
    }
  ]
}