{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://qa-intelligence.com/schemas/tech-inventory-report.json",
  "title": "QA Intelligence Tech Inventory Report",
  "description": "Comprehensive technology stack inventory with confidence-based language recommendation",
  "type": "object",
  "required": [
    "version",
    "timestamp",
    "languages",
    "lockfiles",
    "frameworks",
    "testing",
    "infra",
    "api_contracts",
    "security",
    "recommendation"
  ],
  "properties": {
    "version": {
      "type": "string",
      "description": "Schema version (semver)",
      "pattern": "^\\d+\\.\\d+\\.\\d+$"
    },
    "timestamp": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp of scan"
    },
    "languages": {
      "type": "object",
      "description": "File count by language",
      "required": ["typescript", "python", "go", "javascript"],
      "properties": {
        "typescript": {
          "type": "integer",
          "minimum": 0
        },
        "python": {
          "type": "integer",
          "minimum": 0
        },
        "go": {
          "type": "integer",
          "minimum": 0
        },
        "javascript": {
          "type": "integer",
          "minimum": 0
        }
      }
    },
    "lockfiles": {
      "type": "array",
      "description": "Dependency lockfiles found",
      "items": {
        "type": "string"
      }
    },
    "frameworks": {
      "type": "object",
      "description": "Detected frameworks",
      "properties": {
        "backend": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "frontend": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "testing": {
      "type": "object",
      "description": "Testing frameworks and artifacts",
      "properties": {
        "playwright_ts": {
          "type": "array",
          "description": "Playwright TypeScript test files",
          "items": {
            "type": "string"
          }
        },
        "playwright_py": {
          "type": "array",
          "description": "Playwright Python test files",
          "items": {
            "type": "string"
          }
        },
        "postman_collections": {
          "type": "array",
          "description": "Postman collection files",
          "items": {
            "type": "string"
          }
        },
        "postman_environments": {
          "type": "array",
          "description": "Postman environment files",
          "items": {
            "type": "string"
          }
        },
        "k6_scripts": {
          "type": "array",
          "description": "k6 load test scripts",
          "items": {
            "type": "string"
          }
        },
        "newman_configs": {
          "type": "array",
          "description": "Newman configuration files",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "infra": {
      "type": "object",
      "description": "Infrastructure as Code and configurations",
      "properties": {
        "helm": {
          "type": "array",
          "description": "Helm chart files",
          "items": {
            "type": "string"
          }
        },
        "terraform": {
          "type": "array",
          "description": "Terraform files",
          "items": {
            "type": "string"
          }
        },
        "kubernetes": {
          "type": "array",
          "description": "Kubernetes manifest files",
          "items": {
            "type": "string"
          }
        },
        "docker": {
          "type": "array",
          "description": "Docker-related files",
          "items": {
            "type": "string"
          }
        },
        "nats": {
          "type": "boolean",
          "description": "NATS messaging detected"
        },
        "postgres": {
          "type": "boolean",
          "description": "PostgreSQL detected"
        },
        "redis": {
          "type": "boolean",
          "description": "Redis detected"
        },
        "qdrant": {
          "type": "boolean",
          "description": "Qdrant vector DB detected"
        },
        "neo4j": {
          "type": "boolean",
          "description": "Neo4j graph DB detected"
        },
        "opentelemetry": {
          "type": "boolean",
          "description": "OpenTelemetry observability detected"
        }
      }
    },
    "api_contracts": {
      "type": "object",
      "description": "API contract specifications",
      "properties": {
        "openapi": {
          "type": "array",
          "description": "OpenAPI specification files",
          "items": {
            "type": "string"
          }
        },
        "swagger": {
          "type": "array",
          "description": "Swagger specification files",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "security": {
      "type": "object",
      "description": "Security-related files and patterns",
      "properties": {
        "env_files": {
          "type": "array",
          "description": "Environment files (.env, .env.example)",
          "items": {
            "type": "string"
          }
        },
        "license_files": {
          "type": "array",
          "description": "License files",
          "items": {
            "type": "string"
          }
        },
        "secret_patterns": {
          "type": "array",
          "description": "Files with potential secret patterns",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "recommendation": {
      "type": "object",
      "description": "Language recommendation with confidence scoring",
      "required": ["language", "confidence", "scores", "rationale"],
      "properties": {
        "language": {
          "type": "string",
          "enum": ["TypeScript", "Python", "Go", "Hybrid"],
          "description": "Recommended language for CMO/ELG implementation"
        },
        "confidence": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "Confidence score (0.0 - 1.0)"
        },
        "scores": {
          "type": "object",
          "description": "Weighted scores by language",
          "required": ["typescript", "python", "go"],
          "properties": {
            "typescript": {
              "type": "number",
              "minimum": 0,
              "maximum": 1
            },
            "python": {
              "type": "number",
              "minimum": 0,
              "maximum": 1
            },
            "go": {
              "type": "number",
              "minimum": 0,
              "maximum": 1
            }
          }
        },
        "rationale": {
          "type": "array",
          "description": "Evidence-based reasoning for recommendation",
          "items": {
            "type": "string"
          },
          "minItems": 1
        },
        "fallback": {
          "type": "string",
          "enum": ["TypeScript", "Python", "Go"],
          "description": "Fallback language if primary fails"
        },
        "libraries": {
          "type": "object",
          "description": "Recommended libraries for CMO/ELG components",
          "properties": {
            "messaging": {
              "type": "string"
            },
            "state_store": {
              "type": "string"
            },
            "object_storage": {
              "type": "string"
            },
            "vector_db": {
              "type": "string"
            },
            "graph_db": {
              "type": "string"
            },
            "policy_engine": {
              "type": "string"
            },
            "observability": {
              "type": "string"
            },
            "schema_validation": {
              "type": "string"
            }
          }
        }
      }
    }
  }
}
